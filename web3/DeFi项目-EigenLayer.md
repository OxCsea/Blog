# DeFi EigenLayer

## 项目介绍

## 背景

以太坊的 PoS 机制要求用户质押 32 ETH 来成为验证者。但这些 ETH 被锁定，无法再参与其他协议的安全共识。EigenLayer 的创新是：**允许已经质押的 ETH 衍生品（如 LST：stETH、rETH 等）在保证原链安全的基础上，授权给新的服务（AVS）使用其“信任背书”。**

> 比如：如果一个新项目想自己搭个验证系统、找人来质押担保安全，它就得重新建立一套机制、吸引质押者，非常浪费。

### 定位

EigenLayer 是以太坊上的“再质押”协议，用来复用已有质押资产（如 stETH）提供更多安全性服务，从而获得额外收益。

> 将 stETH 再质押到 EigenLayer，**stETH 本身的 PoS 收益你照拿**，**但额外的“再质押收益”并不固定**，完全取决于你支持的 AVS 是否给予奖励（如空投、代币分红）。

| 功能                          | 说明                                                         |
| ----------------------------- | ------------------------------------------------------------ |
| 再质押（Restaking）           | 把已经在以太坊上质押的 ETH/stETH 拿来，再抵押给其他协议、模块，提供它们所需的验证安全性 |
| 模块市场（AVS）               | AVS = Actively Validated Services，任何项目都可以在 EigenLayer 上搭建模块，调用再质押安全性，比如排序器、预言机、桥等 |
| 共享安全性（Shared Security） | AVS 不再自己搞质押，直接用 EigenLayer 连接的 ETH 节点来提供验证，更高效、更可信 |
| 激励机制                      | 再质押者会收到 AVS 的奖励，也可能获得 EigenLayer 的原生代币空投（目前还未上线） |

### 用户

| 动作                           | 说明                                                         |
| ------------------------------ | ------------------------------------------------------------ |
| 直接质押 ETH（原生再质押）     | 最初只有这一种方式，需自行运行节点，门槛较高                 |
| 委托再质押（Liquid Restaking） | 新增支持 Liquid Token：stETH、rETH、cbETH、ethX、eETH 等，可以一键将它们再质押，门槛低 |
| 等待空投、收益                 | 目前 AVS 激励机制还未完全上线，用户现在主要是“提前参与”以博得后续收益和空投 |

### 再质押

可以通过这些LRT（Liquid Restaking Token）协议对 stETH/rETH 等进行再质押：

| 协议                 | 支持资产   | 可获得凭证                 |
| -------------------- | ---------- | -------------------------- |
| Ether.fi             | ETH、eETH  | 可用于 DeFi，计划发币      |
| Renzo                | ETH、ezETH | ezETH 可被用来做 DeFi 组合 |
| Kelp DAO             | stETH、ETH | rsETH 是其再质押凭证       |
| EigenPie（Balancer） | 多种 LST   | pieETH、pieLRT             |

## Restaking机制

### 技术机制

1. **智能合约：RestakingManager** 用户将 LST（如 stETH）存入 EigenLayer 的 RestakingManager 合约，系统记录用户地址、资产、数量和授权的 AVS。
2. **注册 AVS：AVSRegistry + AVSManager** 每个 AVS（如 EigenDA、Lagrange）必须注册并部署自己的 AVS 合约模块，写明：
   1. 需要哪类资产支持（ETH, stETH, etc.）
   2. 想要验证者运行哪些 AVS 功能
   3. 惩罚/奖励规则（比如误行为的 Slash 条件）
3. **Validator 与 AVS交互**
   1. 验证者通过一个通用的 AVS 接口连接多个服务。
   2. 每个 AVS 定义验证者要运行的节点软件，例如数据可用层（DA）、预言机等。
4. **惩罚机制：Slasher 模块** 如果 AVS 验证者有恶意或离线行为，系统可以通过 Slasher 合约对其 stake 执行惩罚（slashing），降低网络风险。

### 再质押合约（Restaking Contract）

用户与 EigenLayer 的**交互入口**

> 这个合约是用户角度的“资金控制台”，是你参与 restaking 的唯一入口。

| 功能           | 说明                                                         |
| -------------- | ------------------------------------------------------------ |
| 用户质押入口   | 用户将 ETH、stETH、rETH 等资产，存入这个合约，视为“再质押”开始 |
| 记录质押人信息 | 合约会记录：谁质押、质押了多少、何时开始、是否允许用于某个 AVS |
| 授权机制       | 用户可以选择是否允许自己的再质押资产用于某个 AVS 服务（opt-in） |
| 提现管理       | 如果用户想退出再质押，先发起 unlock，经过延迟期才能领取资产  |

### AVS 注册合约（AVS Manager Contract）

这是 AVS 项目方向 EigenLayer 注册服务用的合约

> 这是 AVS 项目方对外提供“任务”的界面，验证者/节点从此获取任务。

| 功能              | 说明                                                         |
| ----------------- | ------------------------------------------------------------ |
| 注册验证者需求    | AVS 在此注册：我要 200 个节点，具备 xx 条件，并上传验证代码接口 |
| 监控 AVS 运行状态 | EigenLayer 监控：节点是否执行 AVS 任务？AVS 是否稳定运行？   |
| 惩罚与奖励管理    | 如果 AVS 出现问题，会根据注册协议，对不配合的验证者进行 slashing 惩罚或奖励派发 |

### 交互路径

```Java
你（用户）
│
│→ 存入 stETH → Restaking Contract（登记质押）
│                        ↓
│                        允许用于某个 AVS → AVS 注册合约登记
│                                                  ↓
│                           验证者从你这借用质押信用，提供服务
│                                                  ↓
│                    AVS 项目给验证者/你分发奖励（ETH/token/bribe）
```

## 用户、节点、AVS 三角结构如何运作

理解 EigenLayer 的经济模型，需要清楚三方关系：

1. 用户（Restaker）

- 把 stETH、ETH、rETH 存入 EigenLayer 合约
- 选择授权支持哪些 AVS
- 拿到奖励：ETH本身的staking收益 + AVS可能分发的空投或代币激励

1. 节点运营者（Operator）

- 运行 EigenLayer 兼容节点
- 同时为多个 AVS 提供验证服务
- 收取 AVS 发放的运营奖励，通常会与出借 stake 的用户分享一部分（可通过 EigenLayer 授权设置）

1. AVS 项目方（如 EigenDA）

- 注册服务到 EigenLayer 平台
- 提供节点软件让验证者运行
- 给出代币激励或分红，吸引 restaker 参与，扩大 AVS 安全性

## 收益模式

EigenLayer **自己不产币、不发利息**，也不承诺你任何收益。

你获得的收益，**完全取决于你选择支持的 AVS 是否愿意发奖励**，是否做了空投，是否上线主网开始分红。

### 纯用户

对普通投资者：**你只需 restake、选择安全 AVS，等收益发放或未来代币**

> 作为普通用户虽然不运行 AVS，但通过 restake 为 AVS 提供了安全担保（经济支持）。因此一些 AVS 在分发代币时，会将部分代币分配给支持其服务的 restaker（通常通过 EigenLayer 合约中数据快照实现分发）。此外，如果某 AVS 项目有激励计划，用户在第一时间 restake 支持该 AVS，也可能成为“早期贡献者”，优先获得空投或 bribe 激励。

| 情况                      | 说明                                                         |
| ------------------------- | ------------------------------------------------------------ |
| 某 AVS 开启空投或激励活动 | 你持有 stETH 并 restake，允许参与这个 AVS，就可能成为 eligible 用户 |
| AVS 提前公布空投规则      | 比如：EigenDA 会对所有 restake eETH 用户发币                 |
| 风险                      | 有些 AVS 有 slashing 机制，可能被罚，需要看是否 opt-in 风险 AVS |

| 操作          | 工具                                                         |
| ------------- | ------------------------------------------------------------ |
| Restake stETH | 官方网页 [EigenLayer App](https://app.eigenlayer.xyz/) → Connect Wallet → Restake |
| 查看当前 AVS  | 在 EigenLayer Dashboard 查看哪些 AVS 项目正在注册、是否 opt-in |
| 判断空投潜力  | 观察 AVS 是否有代币计划、早期测试、社交媒体动向等            |

### 验证者节点

对机构/团队亲自为 AVS 执行任务（更专业）：这属于专业级玩法，普通用户不建议直接上手

| 情况                         | 说明                                                |
| ---------------------------- | --------------------------------------------------- |
| 你运行服务器参与验证         | 比如你是 Lido 的 Node Operator，本身就 run 验证节点 |
| 现在你再 run EigenLayer 容器 | 同时为 AVS 提供证明、共识、排序、挑战等服务         |
| 奖励更丰厚                   | 通常会获得更高比例的 AVS 原生币、bribe、手续费等    |

## AVS

### 定义

AVS 全称：**Actively Validated Service**（主动验证服务）

是一些**不直接运行在以太坊主链上**的模块化服务，它们可以使用 EigenLayer 的**再质押机制来获得安全性**

你可以理解为它们是“以太坊侧边开出来的新跑道”，但希望借助以太坊的安全性来运行自己的服务

### 类型

#### 1. **数据可用性（DA）**

这些 AVS 负责提供“链下数据发布”服务，常用于模块化区块链系统。

- **代表项目：EigenDA、Avail、Celestia**
- **功能场景**：发布 L2 区块数据、Rollup 执行数据
- **赚钱方式**：按数据发布量计费、以代币形式支付

#### 2. **去中心化证明/证明服务（ZK Proof、State Proof）**

这些服务验证 ZK 证明或提供链间验证能力。

- **代表项目：Lagrange、Succinct、HyperOracle**
- **功能场景**：ZK 跨链桥、状态证明、可验证计算
- **赚钱方式**：为 L2、链间桥提供状态验证，赚桥费或协议激励

#### 3. **排序器 / 去中心化共识网络**

用于 L2 或 AppChain 的排序、共识服务。

- **代表项目：Espresso、Astria**
- **功能场景**：代替中心化 Sequencer 提供公平排序
- **赚钱方式**：收取区块发布费、交易排序费

#### 4. **预言机服务（Oracle）**

提供高频链下数据喂价、链间价格验证等服务。

- **代表项目：Redstone、Supra**
- **赚钱方式**：与协议合作提供数据，收取服务费

#### 5. **隐私计算 / MEV 保护 / 自动化服务**

一些新型服务也在 AVS 生态中探索中。

### 热门项目

| AVS 项目     | 类型           | 当前阶段     | 空投潜力 / 奖励机制          |
| ------------ | -------------- | ------------ | ---------------------------- |
| EigenDA      | DA             | 主网上线     | 预计会空投给再质押者         |
| Lagrange     | 状态证明       | 测试网激励中 | 有明确空投计划（已发阶段一） |
| WitnessChain | 轻节点验证     | 主网将上线   | 有 Restaking 积分机制        |
| AltLayer     | L2 Rollup 服务 | 空投已发     | 后续还有计划                 |
| Espresso     | 排序器         | 测试网阶段   | 跟 EigenLayer 有深度合作     |
| RedStone     | Oracle         | 主网阶段     | 已上线主网，已有奖励计划     |

### 风险

目前 AVS 生态处于早期，**很多项目仍未正式上线或发币**

大量用户参与再质押，一旦 AVS 没有兑现预期奖励或代币价值崩塌，**可能只是白质押，收益为零**

某些 AVS 若运作不善，发生漏洞或节点审查失误，可能导致 slashing（惩罚你的再质押资产）

## 策略

### AVS 空投收益机制

1. 当前阶段的 **实际收益来源**

- **AVS 项目代币空投（主力）**：类似 LayerZero、ZkSync 的「使用 - 等待 - 发币 - 空投」节奏。
- **协议未来运行奖励（待观察）**：部分 AVS 表示未来上线后将按验证情况给予真实收益。
- **平台激励**（少量）：如 EigenLayer、Restake Finance 等可能发放平台 token。

1. 空投分配机制常见形式

- **再质押资产的数量与时间**（如 restake 额度 × 天数）
- **是否参与过验证节点活动**（针对节点用户）
- **是否完成任务交互**（如订阅测试网、验证钱包、社群活跃等）

### 设计策略组合的核心思路

#### 策略 1：**单纯空投博弈型再质押**

目标：最大化 AVS 空投预期收益

操作步骤：

1. 将 ETH → Lido → stETH
2. 存入 EigenLayer 官方或 Restake Finance 前端再质押
3. 勾选多个 AVS 服务（如 EigenDA、Lagrange、AltLayer）
4. **定期检查是否注册/白名单/签名任务**等空投要求
5. 考虑绑定 Restake Finance 等聚合器平台（他们也可能发 token）

收益预期：

- 中短期空投收益
- 有概率获得多个 AVS token（分发时间较不确定）

风险：

- AVS 项目跑路 / 放弃发币
- 资产锁定无法退出（若 AVS 不支持转出）

#### 策略 2：**再质押 × Pendle 拆分策略（空投 + 固定收益）**

目标：边博空投，边锁定基础利息收益

操作路径：

1. ETH → stETH
2. stETH → 再质押（EigenLayer）
3. 选择 Restake 的 rstETH（再质押凭证）
4. 在 Pendle 拆分成 PT（本金）+ YT（利息）
5. 选择：
   1. **持有 PT** → 固定锁仓年化收益
   2. **持有 YT** → 押注 AVS 利率飙升（可能因 AVS 热度而涨）

#### 收益来源：

- AVS 空投
- Pendle PT 固定收益（约 3.5-4%）
- Pendle YT 利率博弈收益（高风险高收益）

#### 风险点：

- rstETH 流动性差，可能无法随时退出
- 拆分期间锁仓，错过空投快照
- YT 亏损风险

#### 策略 3：**vePENDLE × AVS 推广池套利**

适合对象：中高级用户，有一定本金

操作思路：

1. 持有 vePENDLE
2. 每周分析有哪些 **AVS 项目（或相关资产）在 Pendle 上有 bribe 推广池**
3. 将投票权投向 bribe 多的池子，获取外部代币
4. 若 bribe 总收益远高于 LP 收益，考虑退出 LP 转为 vePENDLE

收益来源：

- bribe 外部代币奖励（空投前期诱饵）
- PENDLE 本身价格上涨收益

风险点：

- bribe 项目兑现率不稳定
- vePENDLE 锁仓周期长（2年）

##### 策略 4：**Restake × DeFi 跨协议收益组合**

目标：多重收益叠加

| 操作路径                              | 收益点                                   |
| ------------------------------------- | ---------------------------------------- |
| stETH → EigenLayer → restake → rstETH | AVS 空投 + Restake Platform 激励         |
| rstETH → Pendle 拆分                  | 固定收益（PT）+ 收益权交易（YT）         |
| YT + PT 做 LP（Pendle）               | Pendle 手续费 + PENDLE 激励 + ve投票套利 |
| 持有 vePENDLE                         | Pendle bribe 收益                        |

> 如果未来 eETH / rsETH 被 Pendle 支持 → 相同策略继续复制、轮动

## 问题

### 为什么要将 stETH 再质押，帮别的协议维稳安全性？

> 利用 stETH 背后的验证者，为更多协议提供安全服务，赚额外激励

背后的核心逻辑是：

- 以太坊上的 ETH 质押者，本来只在 **PoS 共识系统** 中提供安全性。
- **其他 Web3 协议（尤其是跨链桥、预言机、排序服务等）也需要“验证者”来保障其运行的安全性**，但又不想自己从头拉人质押、建立安全机制。
- **EigenLayer 提供“验证者即服务”平台**：这些 stETH 背后就是验证节点，现在我来把你 stETH 绑定到新的 AVS（模块）上，只要这些节点承诺也为 AVS 做验证，那你 stETH 持有人就能拿到 AVS 的奖励。

所以，**再质押 ≠ 重新质押 ETH，而是用 stETH 背后的 ETH 再做一件事**：去参与其他协议的安全验证。

### 什么项目需要验证系统？

> 跨链桥、预言机、排序器、模块化公链、ZK 系统等

| 项目类型                                | 为什么需要验证？                                   |
| --------------------------------------- | -------------------------------------------------- |
| 跨链桥                                  | 确保转账数据不被篡改，要验证两边链上状态           |
| 预言机服务                              | 数据上链之前，需要有节点确认数据真实               |
| Layer2 排序器                           | Sequencer 需要中心化 or 去中心化排序，保证顺序一致 |
| 新公链 / 新模块化组件（如 Celestia DA） | 本身没有 PoS 验证机制，需要“借用”以太坊的安全性    |

### 为什么要用 EigenLayer 而不是自己搭？

**使用 EigenLayer 就像“租用验证者”**，直接连接以太坊已有的质押系统，安全性强、成本低。

自己搭 = 要找很多人质押，还要设置 slashing、治理、安全规则，成本非常高，还不一定有足够声誉和 TVL，让用户愿意参与

| 传统方式                                       | 用 EigenLayer 的优势                                         |
| ---------------------------------------------- | ------------------------------------------------------------ |
| 搭建自己的验证者网络，拉用户锁仓 ETH，成本极高 | 直接使用 EigenLayer 的验证者网络，快速接入成千上万个节点，安全性即插即用 |
| 需要设计 slashing/共识机制                     | EigenLayer 提供标准化接口，挂钩以太坊经济安全性              |
| 用户对新链信任门槛高                           | 借用以太坊质押者信用，降低冷启动难度                         |

#### 是否会影响以太坊验证性能

不会。再质押是**逻辑绑定**，不是**资源混用**。只要验证者愿意，就能独立提供 AVS 服务，并赚额外奖励，不会影响主链验证。

| 职责类型                          | 工作范围                 | 举例                                   |
| --------------------------------- | ------------------------ | -------------------------------------- |
| ① 主网验证任务（来自 ETH PoS）    | 出块、验证、签名等       | Lido 验证节点为主链出块赚 ETH 质押收益 |
| ② AVS 附加任务（来自 EigenLayer） | 独立模块、自定义数据处理 | 验证跨链桥数据、ZK 证明、预言机信息等  |

**EigenLayer 要求参与 AVS 的验证者必须**：

- 拥有与 ETH 主网分离的 AVS 专用客户端/容器
- 明确承诺“额外配置计算资源”服务 AVS

所以不是“一台机器做两件事”，而是：

- ETH主网的出块 → 继续使用验证者原有设置
- AVS 验证 → 验证者需要为每个 AVS **单独部署服务容器**

#### 给了 gas 就有人验证，为啥还需要 AVS 专属验证节点？

> 以太坊本来就是一个公共网络，我发交易给 gas 不就有矿工处理吗？为啥还需要找 EigenLayer 验证？

AVS 不是普通交易，它是“独立模块的共识层”。

| 类别                   | 谁负责验证？            | 举例                         | 安全机制              |
| ---------------------- | ----------------------- | ---------------------------- | --------------------- |
| 普通合约（如 Uniswap） | ETH 主网共识层          | 你发交易，矿工打包验证       | 付 gas 即可           |
| AVS 服务（如跨链桥）   | EigenLayer 的验证者集群 | 自己有数据、链外信息、ZK证据 | 需 AVS 专用共识验证者 |

假设你要跨链转 100 USDC 到 BNB 链

1. 你在链 A 上转账给桥 → 桥记录信息
2. 桥要把这个信息告诉链 B（BNB）
3. 中间必须有人验证：你真转了？不是伪造的？

**AVS 的作用就是做这种“链间中介 + 状态证明”的工作。** 这不能依靠 ETH 主网矿工处理，因为 ETH 主网验证的只是 EVM 合约，而不是链外或链间数据。

所以 AVS 专属验证的意义：

1. 提供“ETH 共识之外”的安全验证服务
2. 对 AVS 项目方来说 → 不用自己搭验证集群，直接借用 EigenLayer 验证者
3. 对验证者来说 → 可以接更多 AVS 任务，赚更多奖励

| 问题                 | 结论                                                       |
| -------------------- | ---------------------------------------------------------- |
| 再质押是否拖慢原任务 | ❌ 不会，AVS 用的是验证者额外部署的资源，不干扰主链         |
| 为什么还要专属验证   | AVS 的任务不属于 ETH 共识范畴，必须用独立的 AVS 验证者执行 |

### stETH 明明已经是质押 ETH 的凭证，为什么还能再拿去“再质押”？是不是循环了？

> stETH 是 ETH 质押的凭证，代表验证权，可以复用给其他协议，EigenLayer 会追溯到对应的验证节点并进行管理

看似是循环，其实是“多任务复用”。

假设你有一个押金 1 万的 Airbnb 账号（= ETH 被 Lido 质押），Lido 给了你一个“租房信誉凭证”（= stETH），代表你已经押了钱。

你现在：

- 继续住 Airbnb（=享受 ETH 质押收益）
- 拿这张租房凭证，再去参加另外一个平台说：“我这张凭证已经押了 1 万了，我愿意帮你做房源审核任务，你给我额外奖励。”

你并没有凭空创造 ETH，而是： **让“同一份 ETH 所代表的安全性，被复用到更多地方，赚更多钱”。**

### 技术上是怎么做到的？

1. Lido 拿你质押的 ETH，给你 stETH。
2. 你把 stETH 提交给 EigenLayer。
3. EigenLayer 去检查：这个 stETH 是真的？是合法的吗？
4. EigenLayer 把 stETH 对应的验证者节点标记为“这个人也愿意为 AVS 提供安全保障”。
5. 如果 AVS 验证失败或作恶，EigenLayer 就对这个验证者发起 slashing（从 ETH 那边扣钱）。
6. 你因此承担风险（资产会缩水），但也有机会拿到 AVS 的奖励（收益、空投等）。

### 如果你是验证者，怎么判断是否接入某个 AVS？

| 评估维度       | 说明                                                         |
| -------------- | ------------------------------------------------------------ |
| 💰 收益预期     | 这个 AVS 每周/每月会向验证者支付多少 ETH 或 token？收益是否高于部署和维护 AVS 的边际成本？有无贿赂机制？ |
| 🧮 成本评估     | 部署新 AVS 需开新容器/服务端口，占用 CPU、内存、网络等资源，是否有运维难度？ |
| 📈 增长潜力     | AVS 所处赛道是否增长（如 L2、预言机、ZK 模块、跨链桥）？是否有代币、空投、TVL 增长？ |
| 🛡️ 风险隔离机制 | 若 AVS 被攻击或故障，是否会拖累验证者质押资产？有没有 slashing 或罚没机制？ |
| 🤝 协议稳定性   | 背后团队是否靠谱？是否有社区治理与 roadmap？谁是早期用户？是否有大项目采用？ |
